<c:Window
    x:Class="LogicSimulator.Views.Windows.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:c="clr-namespace:LogicSimulator.Controls;assembly=LogicSimulator.Controls"
    xmlns:con="clr-namespace:LogicSimulator.Infrastructure.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:fa="http://schemas.fontawesome.io/icons/"
    xmlns:fa5="http://schemas.fontawesome.com/icons/"
    xmlns:infrastructure="clr-namespace:LogicSimulator.Infrastructure"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModels="clr-namespace:LogicSimulator.ViewModels"
    xmlns:views="clr-namespace:LogicSimulator.Views"
    Title="Logic-simulator"
    Width="1280"
    Height="720"
    DataContext="{Binding Path=MainWindowViewModel,
                          Source={StaticResource Locator}}"
    Icon="/Icons/icon512x512.png"
    mc:Ignorable="d">

    <c:Window.Resources>
        <con:Vector2Converter x:Key="Vector2Converter" />
    </c:Window.Resources>

    <DockPanel>
        <Grid DockPanel.Dock="Top">
            <Menu>
                <MenuItem Header="Файл">
                    <MenuItem Header="Новый" />
                    <MenuItem Command="{Binding Path=LoadExampleCommand}" Header="Загрузить пример" />
                    <MenuItem Command="{Binding Path=SaveExampleCommand}" Header="Сохранить пример" />
                    <Separator />
                    <MenuItem Header="Выход" />
                    <MenuItem Command="{Binding Path=TestCommand}" Header="Тест" />
                </MenuItem>
            </Menu>

            <Button
                Height="21"
                Margin="2,0,2,0"
                Padding="5"
                HorizontalAlignment="Right"
                VerticalAlignment="Center"
                Background="Transparent"
                BorderThickness="0">
                <fa:ImageAwesome
                    Foreground="White"
                    Icon="Cog"
                    SnapsToDevicePixels="True"
                    UseLayoutRounding="True" />
            </Button>
        </Grid>

        <StatusBar Background="#424242" DockPanel.Dock="Bottom">
            <TextBlock
                Margin="0,0,5,0"
                Foreground="White"
                Text="{Binding Path=ActiveContent.Scale,
                               StringFormat='Масштаб: {0:0.00}',
                               FallbackValue=''}" />
            <TextBlock
                Margin="0,0,5,0"
                Foreground="White"
                Text="{Binding Path=ActiveContent.MousePosition,
                               StringFormat='Позиция курсора: {0}',
                               Converter={StaticResource Vector2Converter},
                               FallbackValue=''}" />
            <TextBlock
                Margin="0,0,5,0"
                Foreground="White"
                Text="{Binding Path=ActiveContent.Objects.Count,
                               StringFormat='Кол-во объектов: {0}',
                               FallbackValue=''}" />
        </StatusBar>

        <DockingManager
            ActiveContent="{Binding Path=ActiveContent,
                                    Mode=TwoWay}"
            AnchorablesSource="{Binding Path=AnchorableViewModels}"
            DocumentsSource="{Binding Path=SchemeViewModels}">
            <DockingManager.LayoutItemTemplateSelector>
                <infrastructure:PanesTemplateSelector>
                    <infrastructure:PanesTemplateSelector.SchemeViewTemplate>
                        <DataTemplate DataType="{x:Type viewModels:SchemeViewModel}">
                            <views:SchemeView />
                        </DataTemplate>
                    </infrastructure:PanesTemplateSelector.SchemeViewTemplate>
                    <infrastructure:PanesTemplateSelector.PropertiesViewTemplate>
                        <DataTemplate DataType="{x:Type viewModels:PropertiesViewModel}">
                            <views:PropertiesView />
                        </DataTemplate>
                    </infrastructure:PanesTemplateSelector.PropertiesViewTemplate>
                </infrastructure:PanesTemplateSelector>
            </DockingManager.LayoutItemTemplateSelector>
            <DockingManager.LayoutItemContainerStyleSelector>
                <infrastructure:PanesStyleSelector>
                    <infrastructure:PanesStyleSelector.SchemeViewStyle>
                        <Style TargetType="{x:Type LayoutDocumentItem}">
                            <Setter Property="Title" Value="{Binding Model.Name}" />
                            <Setter Property="CanClose" Value="False" />
                        </Style>
                    </infrastructure:PanesStyleSelector.SchemeViewStyle>
                    <infrastructure:PanesStyleSelector.PropertiesViewStyle>
                        <Style TargetType="{x:Type LayoutAnchorableItem}">
                            <Setter Property="Title" Value="{Binding Model.Name}" />
                            <Setter Property="CanClose" Value="True" />
                        </Style>
                    </infrastructure:PanesStyleSelector.PropertiesViewStyle>
                </infrastructure:PanesStyleSelector>
            </DockingManager.LayoutItemContainerStyleSelector>

            <LayoutRoot>
                <LayoutPanel>
                    <LayoutDocumentPane />
                </LayoutPanel>
            </LayoutRoot>
        </DockingManager>
    </DockPanel>
</c:Window>
